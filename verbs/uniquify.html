


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Uniquify &mdash; Scala Words - Documentation</title>
    
    <link rel="stylesheet" href="../static/style.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../static/prettify.css" type="text/css" />
    <link rel="stylesheet" href="../static/base.css" type="text/css" />
    <link rel="stylesheet" href="../static/docs.css" type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Exo:300,400,600,700" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="../static/toc.js"></script>
    <script type="text/javascript" src="../static/prettify.js"></script>
    <script type="text/javascript" src="../static/highlightCode.js"></script>
    <script type="text/javascript" src="../static/effects.core.js"></script>
    <script type="text/javascript" src="../static/effects.highlight.js"></script>
    <script type="text/javascript" src="../static/scrollTo.js"></script>
    <script type="text/javascript" src="../static/contentsFix.js"></script>
    <script type="text/javascript" src="../static/ga.js"></script>
    <link rel="shortcut icon" href="../static/favicon.ico"/>
    <link rel="top" title="Scala Words - Documentation" href="../index.html" />
    <link rel="up" title="Verbs" href="index.html" />
    <link rel="next" title="Ask" href="ask.html" />
    <link rel="prev" title="Timed" href="timed.html" />

  </head>
  <body>
  <div class="navbar">
    <div class="navbar-inner">
      <div class="container">
        <div class="navbar-logo">
        </div>    
      </div>
    </div>
  </div>
  <div class="main">
    <div class="container">
      <div class="page-title" style="padding-top:0.75em">
        <a href="../index.html" style="color: white; background: url(../static/logo-small.png) no-repeat; height: 40px; padding-left: 62px; padding-top: 1em; margin-top: 1em; padding-bottom: 0.5em">
        <span style="padding-bottom: 1em">Uniquify
        </a>
      </div>
      <div class="pdf-link"><a href="../ScalaSlides.pdf"><img src="../static/pdf-icon.png" style="height: 40px;" /></a></div>
    </div>
    <div class="main-container">
      <div class="container">
        <div class="row">
          <div class="span12">
            <ul class="breadcrumb">           
              <li>
                 <span class="divider">|</span> <a href="ask.html">Ask</a> <span class="divider">»</span>
              </li>
              <li>
                <a href="../index.html">Contents</a>
              </li>
              <li>
                <span class="divider">«</span> <a href="timed.html">Timed</a> <span class="divider">|</span>
              </li>
              <li>
                Version 0.1
              </li>
            </ul>         
          </div>
        </div>
        <div class="row">
          <div class="span9">
            
  <div class="section" id="uniquify">
<h1>Uniquify</h1>
<div class="section" id="use-case">
<h2>Use case</h2>
<p>You want to get an unique <tt class="docutils literal"><span class="pre">List</span></tt>, and sadly a Set just won&#8217;t cut it because uniqueness is determined by some key inside the data structure.</p>
</div>
<div class="section" id="uniquify-a-list-based-on-some-key">
<h2>Uniquify a List, based on some Key</h2>
<p>Given some list of <tt class="docutils literal"><span class="pre">Data</span></tt>, you want to get all unique Data elements, where uniqueness is determined by it&#8217;s <tt class="docutils literal"><span class="pre">a</span></tt> value.</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">case</span> <span class="k">class</span> <span class="nc">Data</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>

<span class="k">import</span> <span class="nn">UniquifyVerb._</span>

<span class="c1">// given</span>
<span class="k">val</span> <span class="n">list</span> <span class="k">=</span> <span class="nc">Data</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">::</span> <span class="nc">Data</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span> <span class="o">::</span> <span class="nc">Data</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span> <span class="o">::</span> <span class="nc">Data</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span> <span class="o">::</span> <span class="nc">Nil</span>

<span class="c1">// when</span>
<span class="k">val</span> <span class="n">uniques</span> <span class="k">=</span> <span class="n">list</span><span class="o">.</span><span class="n">uniquifyOn</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">a</span><span class="o">)</span>

<span class="c1">// then</span>
<span class="n">uniques</span> <span class="n">should</span> <span class="n">have</span> <span class="n">length</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span>
<span class="n">uniques</span> <span class="n">should</span> <span class="o">(</span><span class="n">contain</span> <span class="o">(</span><span class="nc">Data</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">))</span> <span class="n">and</span> <span class="n">contain</span> <span class="o">(</span><span class="nc">Data</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="uniquify-by-merging-data">
<h2>Uniquify by merging data</h2>
<p>Imagine you have a stream of events, such as shopping cart operations you want to play back and uniquify on some key.
You may need to merge some events, using some kind of business logic (&#8220;don&#8217;t remove items, just add them all&#8221; - for example),
using <tt class="docutils literal"><span class="pre">uniquifyByMerge</span></tt> you can easily do this:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">import</span> <span class="nn">UniquifyVerb._</span>
<span class="k">case</span> <span class="k">class</span> <span class="nc">Data</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">date</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>

<span class="c1">// given</span>
<span class="k">val</span> <span class="n">list</span> <span class="k">=</span> <span class="nc">Data</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">date</span> <span class="k">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">::</span> <span class="nc">Data</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">date</span> <span class="k">=</span> <span class="mi">2</span><span class="o">)</span> <span class="o">::</span> <span class="nc">Data</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">date</span> <span class="k">=</span> <span class="mi">3</span><span class="o">)</span> <span class="o">::</span> <span class="nc">Data</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">date</span> <span class="k">=</span> <span class="mi">3</span><span class="o">)</span> <span class="o">::</span> <span class="nc">Nil</span>

<span class="c1">// when</span>
<span class="c1">// the merge strategy here is &quot;select newest&quot;</span>
<span class="k">val</span> <span class="n">uniques</span> <span class="k">=</span> <span class="n">list</span><span class="o">.</span><span class="n">uniquifyByMerge</span><span class="o">(</span><span class="n">onKey</span> <span class="k">=</span> <span class="k">_</span><span class="o">.</span><span class="n">a</span><span class="o">)</span> <span class="o">{</span> <span class="k">case</span> <span class="o">(</span><span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">)</span> <span class="k">=&gt;</span>
  <span class="n">info</span><span class="o">(</span><span class="s">&quot;Merge: [%s] and [%s] &quot;</span><span class="o">.</span><span class="n">format</span><span class="o">(</span><span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">))</span>
  <span class="k">if</span><span class="o">(</span><span class="n">l</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;</span> <span class="n">r</span><span class="o">.</span><span class="n">date</span><span class="o">)</span> <span class="n">l</span> <span class="k">else</span> <span class="n">r</span>
<span class="o">}</span>

<span class="c1">// then</span>
<span class="n">uniques</span> <span class="n">should</span> <span class="n">have</span> <span class="n">length</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span>
<span class="n">uniques</span> <span class="n">should</span> <span class="o">(</span><span class="n">contain</span> <span class="o">(</span><span class="nc">Data</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">))</span> <span class="n">and</span> <span class="n">contain</span> <span class="o">(</span><span class="nc">Data</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="uniquify-other-collections">
<h2>Uniquify other collections</h2>
<p>A basic uniquify is also available for other collections, such as Queues etc.
Just use a plain <tt class="docutils literal"><span class="pre">uniquified</span></tt>.</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// given</span>
<span class="k">val</span> <span class="n">nums</span> <span class="k">=</span> <span class="mi">1</span> <span class="o">::</span> <span class="mi">2</span> <span class="o">::</span> <span class="mi">2</span> <span class="o">::</span> <span class="mi">3</span> <span class="o">::</span> <span class="nc">Nil</span>

<span class="c1">// when</span>
<span class="k">val</span> <span class="n">uniquified</span> <span class="k">=</span> <span class="n">nums</span><span class="o">.</span><span class="n">uniquified</span>

<span class="c1">// then</span>
<span class="n">uniquified</span> <span class="n">should</span> <span class="n">have</span> <span class="n">length</span> <span class="o">(</span><span class="mi">3</span><span class="o">)</span>
<span class="n">uniquified</span> <span class="n">should</span> <span class="o">(</span><span class="n">contain</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="n">and</span> <span class="n">contain</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="n">and</span> <span class="n">contain</span> <span class="o">(</span><span class="mi">3</span><span class="o">))</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <div class="span3"><p class="contents-title">Contents</p>
              <div id="scroller-anchor">
                <div id="scroller">
                  <div id="toc"></div>
                </div>
              </div></div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer">
  <div class="container">
    <ul>
      <li><h5>ScalaWords</h5></li>
      <li><a href="http://ktoso.github.com/scala-words">Documentation</a></li>
      <li><a href="http://blog.project13.pl">Blog</a></li>
    </ul>
    <ul>
      <li><h5>Contribute</h5></li>
      <li><a href="http://github.com/ktoso/scala-words">Source Code</a></li>
    </ul>
    <ul>
      <li><img src="../static/watermark.png" align="center"/></li>
    </ul>
  </div>
  <div class="container copyright">
    <p style="float: left;">
      © 2012 <a href="http://blog.project13.pl">Project13.pl</a> <span class="license">ScalaWords is Open Source and available under the Apache 2 License.</span>
    </p>
    <p style="float: right; font-size: 12px;">
      Last updated: Aug 12, 2012
    </p>
  </div>
</div>
<script type="text/javascript">
  $('#toc').toc();
</script>
  

  </body>
</html>